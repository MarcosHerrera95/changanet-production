# âœ… CHECKLIST INTERACTIVO - IMPLEMENTACIÃ“N FIREBASE\n\n## FASE 1: COMMIT LOCAL\n\n### Paso 1.1: Verifica que los archivos fueron modificados\n```bash\ncd changanet-frontend\ngit status\n```\n\n**Esperado que veas:**\n```\nModified:   public/firebase-messaging-sw.js\n??          .env.example\n```\n\n- [ ] âœ… Veo ambos archivos en `git status`\n- [ ] âœ… firebase-messaging-sw.js estÃ¡ en Modified\n- [ ] âœ… .env.example estÃ¡ en ??\n\n---\n\n### Paso 1.2: Revisa el diff exacto\n```bash\ngit diff public/firebase-messaging-sw.js\n```\n\n**Esperado que veas:**\n```diff\n-  storageBucket: \"changanet-notifications.firebasestorage.app\",\n+  storageBucket: \"changanet-notifications.appspot.com\",\n```\n\n- [ ] âœ… Veo la lÃ­nea con storageBucket\n- [ ] âœ… La lÃ­nea antigua tiene \"firebasestorage.app\"\n- [ ] âœ… La lÃ­nea nueva tiene \"appspot.com\"\n\n---\n\n### Paso 1.3: Verifica .env.example\n```bash\nhead -20 .env.example\n```\n\n**Esperado:**\n```\n# ============================================\n# Firebase Cloud Messaging (FCM) Configuration\n# ============================================\nVITE_FCM_VAPID_KEY=BBcq0rChqpfQkexHGzbzAcPNyEcXQ6pHimpgltESqpSgmMmiQEPK2yfv87taE80q794Q_wtvRc8Zlnal75mqpoo\n```\n\n- [ ] âœ… El archivo existe\n- [ ] âœ… Contiene VITE_FCM_VAPID_KEY\n- [ ] âœ… Contiene VITE_BACKEND_URL\n\n---\n\n### Paso 1.4: Hacer el commit\n```bash\ngit add public/firebase-messaging-sw.js .env.example\ngit commit -m \"fix(firebase): unificar storageBucket y documentar variables VAPID\"\n```\n\n**Esperado:**\n```\n[inicio-sesion XXXXXXX] fix(firebase): unificar storageBucket y documentar variables VAPID\n 2 files changed, 17 insertions(+), 1 deletion(-)\n create mode 100644 .env.example\n```\n\n- [ ] âœ… El commit se creÃ³ exitosamente\n- [ ] âœ… Dice \"2 files changed\"\n- [ ] âœ… Sin errores\n\n---\n\n### Paso 1.5: Subir a GitHub\n```bash\ngit push origin inicio-sesion\n```\n\n**Esperado:**\n```\nEnumerating objects: 5, done.\nCounting objects: 100% (5/5), done.\nDelta compression using up to X threads\nCompressing objects: 100% (3/3), done.\nWriting objects: 100% (3/3), ...\nremote: Create a pull request for 'inicio-sesion' on GitHub\n```\n\n- [ ] âœ… Git push completÃ³ sin errores\n- [ ] âœ… Veo mensaje \"Create a pull request\"\n- [ ] âœ… Los cambios estÃ¡n en GitHub (verifica en el browser)\n\n---\n\n## FASE 2: VERIFICACIÃ“N FIREBASE CONSOLE (5 minutos)\n\n### Paso 2.1: Abrir Firebase Console\n1. Ir a: https://console.firebase.google.com\n2. Proyecto: **changanet-notifications**\n3. Click en **Authentication** (lado izquierdo)\n\n- [ ] âœ… Estoy en el proyecto correcto\n- [ ] âœ… Veo \"Authentication\" en el menÃº\n\n---\n\n### Paso 2.2: Verificar Authorized Domains\n1. Click en **Settings** (engranaje arriba a la derecha)\n2. Ir a **Authorized domains** section\n3. Buscar en la lista\n\n**Debe contener:**\n```\nlocalhost\nchanganet-production-xgkf.onrender.com  â† CRÃTICO\n127.0.0.1\n```\n\n- [ ] âœ… Veo \"localhost\"\n- [ ] âœ… Veo \"changanet-production-xgkf.onrender.com\"\n- [ ] âœ… Si falta, hago clic en \"Add domain\" y lo agrego\n\n---\n\n### Paso 2.3: Verificar VAPID Key\n1. Vuelver a **Project Settings** (engranaje)\n2. Click en **Cloud Messaging** tab\n3. Buscar \"Key pair(s) for Cloud Messaging API\"\n4. Copiar el valor de \"Server public key\"\n\n**Debe ser igual a:**\n```\nBBcq0rChqpfQkexHGzbzAcPNyEcXQ6pHimpgltESqpSgmMmiQEPK2yfv87taE80q794Q_wtvRc8Zlnal75mqpoo\n```\n\n- [ ] âœ… Veo la secciÃ³n \"Key pair(s)\"\n- [ ] âœ… Veo un valor de \"Server public key\"\n- [ ] âœ… Es igual al que estÃ¡ en el documento\n- [ ] âœ… Si no existe, crear un nuevo par de claves\n\n---\n\n## FASE 3: CONFIGURAR RENDER FRONTEND (5 minutos)\n\n### Paso 3.1: Ir a Render Dashboard\n1. Ir a: https://dashboard.render.com\n2. Click en tu servicio frontend: **changanet-production-...** (o similar)\n\n- [ ] âœ… Estoy en el dashboard de Render\n- [ ] âœ… Veo mi servicio frontend\n\n---\n\n### Paso 3.2: Configurar variables de entorno\n1. Click en **Settings** (lado izquierdo)\n2. Buscar **Environment** section\n3. Click en **Edit**\n\n**Actualizar/Agregar:**\n```\nVITE_FCM_VAPID_KEY=BBcq0rChqpfQkexHGzbzAcPNyEcXQ6pHimpgltESqpSgmMmiQEPK2yfv87taE80q794Q_wtvRc8Zlnal75mqpoo\nVITE_BACKEND_URL=https://[tu-backend-render-url].onrender.com\n```\n\n- [ ] âœ… Veo las variables de entorno existentes\n- [ ] âœ… Agrego o actualizo VITE_FCM_VAPID_KEY\n- [ ] âœ… Agrego o actualizo VITE_BACKEND_URL (reemplazar [tu-backend-render-url] con URL real)\n- [ ] âœ… Hago click en \"Save\"\n\n---\n\n### Paso 3.3: Redeploy\n1. Click en **Deploys** (lado izquierdo)\n2. Buscar el Ãºltimo deploy\n3. Click en los 3 puntos (...)\n4. Seleccionar **Redeploy**\n5. Confirmar\n\n**Esperar a que diga:**\n```\nDeploy in progress...\nLive\n```\n\n- [ ] âœ… El redeploy comenzÃ³\n- [ ] âœ… EsperÃ© a que termine (2-3 minutos)\n- [ ] âœ… Dice \"Live\" cuando termina\n\n---\n\n## FASE 4: TESTING PRODUCCIÃ“N (5 minutos)\n\n### Paso 4.1: Abrir el sitio en producciÃ³n\n1. Ir a: https://changanet-production-xgkf.onrender.com\n2. Esperar a que cargue completamente\n\n- [ ] âœ… El sitio carga sin errores\n- [ ] âœ… No veo errores en la consola del navegador\n\n---\n\n### Paso 4.2: Testear login\n1. Hacer clic en **Login** o **Sign In**\n2. Entrar con email/password vÃ¡lido\n3. Abrir **DevTools** (F12 en Windows)\n4. Click en **Network** tab\n5. Buscar la llamada a `/api/auth/login`\n6. Hacer click en ella\n7. Mirar la pestaÃ±a **Response**\n\n**Esperado:**\n```\nStatus: 200\nResponse: {\n  \"token\": \"eyJhbGc...\",\n  \"user\": { ... }\n}\n```\n\n- [ ] âœ… La llamada retorna Status 200 (no 401, 403, 500)\n- [ ] âœ… La respuesta contiene un campo \"token\"\n- [ ] âœ… Estoy logged in (veo mi perfil/datos de usuario)\n\n---\n\n### Paso 4.3: Testear Google Sign-in (opcional)\n1. Hacer clic en **\"Sign in with Google\"**\n2. Seleccionar una cuenta Google\n3. Esperar a que se redirige y completa\n\n**Esperado:**\n```\nNo error de CORS\nRedirecciÃ³n exitosa\nLuego, login completado\n```\n\n- [ ] âœ… No hay error de CORS o \"Unauthorized origin\"\n- [ ] âœ… Google sign-in se completa\n- [ ] âœ… Veo que estoy logged in\n\n---\n\n### Paso 4.4: Testear FCM (notificaciones)\n1. Luego de estar logged in\n2. Abrir **DevTools** > **Console**\n3. Buscar mensajes que digan:\n```\n[FCM] Token obtained: eyJhbGc...\n```\n\n- [ ] âœ… Veo el mensaje \"Token obtained\"\n- [ ] âœ… O similar indicando que FCM inicializÃ³\n- [ ] âœ… Si no veo esto, revisar la consola para ver si hay errores\n\n---\n\n### Paso 4.5: Verificar CORS\n1. En DevTools > **Network**\n2. Cualquier llamada al backend\n3. Ir a **Response Headers**\n4. Buscar:\n```\nAccess-Control-Allow-Origin: https://changanet-production-xgkf.onrender.com\nAccess-Control-Allow-Credentials: true\n```\n\n- [ ] âœ… Veo ambos headers\n- [ ] âœ… El origen coincide con mi frontend URL\n- [ ] âœ… Credentials estÃ¡ en true\n\n---\n\n## âœ… IMPLEMENTACIÃ“N COMPLETADA\n\nSi marcaste todas las casillas:\n\n```\nðŸŽ‰ Â¡FIREBASE ESTÃ CORRECTAMENTE CONFIGURADO EN PRODUCCIÃ“N!\n\nâœ… StorageBucket unificado\nâœ… Variables de entorno documentadas\nâœ… Authorized domains verificadas\nâœ… VAPID key confirmada\nâœ… Render redeploy completado\nâœ… Login funciona\nâœ… FCM inicializa\nâœ… CORS configurado\n\nEstatus: ðŸŸ¢ PRODUCCIÃ“N LISTA\n```\n\n---\n\n## âš ï¸ SI ALGO FALLÃ“\n\n**Error: \"Unauthorized origin\" en Google Sign-in**\nâ†’ Agregar el dominio frontend en Firebase Console > Google OAuth configuratio\n\n**Error: CORS o \"cannot reach backend\"**\nâ†’ Verificar VITE_BACKEND_URL en Render estÃ¡ correcta\nâ†’ Verificar que backend tambiÃ©n estÃ¡ en Render\n\n**Error: FCM no obtiene token**\nâ†’ Verificar VITE_FCM_VAPID_KEY en Render environment variables\nâ†’ Verificar que matches el valor en Firebase Console\n\n**Error: Login retorna 401/403**\nâ†’ Revisar que backend CORS config permite el frontend URL\nâ†’ Revisar que backend tiene NODE_ENV=production (para cookies)\n\n---\n\n## ðŸ“ž RECURSOS\n\nSi necesitas help:\n1. Ver `FIREBASE_AUDIT_COMPLETO.md` para detalles tÃ©cnicos\n2. Ver `CODIGO_CORREGIDO_FIREBASE_FINAL.md` para cÃ³digo de referencia\n3. Ver `GUIA_VISUAL_CAMBIOS_FIREBASE.md` para diagramas\n\n---\n\n**Estimado de tiempo total: 20 minutos**\n**Complejidad: Media (simple pero requiere varios pasos)**\n**Riesgo: Muy bajo (cambios son reversibles)**\n\nâœ… **Â¡Adelante!**\n"